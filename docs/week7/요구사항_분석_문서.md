# 요구사항 분석 문서

## 1. 프로젝트 목표 정의

### 1.1 해결하고자 하는 문제

현재 주문-결제, 좋아요-집계 로직이 하나의 트랜잭션에 강하게 결합되어 있어 다음과 같은 문제가 발생한다.

- 외부 I/O(결제 등)가 메인 트랜잭션에 포함되어 장애 전파 위험 존재
- 부가 로직(집계, 로깅 등) 실패 시 핵심 로직도 함께 롤백될 수 있음

### 1.2 프로젝트 목표

이벤트 기반으로 주요 로직과 부가 로직의 트랜잭션 경계를 분리한다.

- 주요 로직: 비즈니스 핵심 기능으로, 실패 시 전체 작업이 롤백되어야 하는 로직
- 부가 로직: 핵심 기능의 성공/실패와 무관하게 처리되는 로직 (집계, 로깅, 외부 전송 등)

### 1.3 기대 효과

- 시스템 안정성 향상: 부가 로직 실패가 핵심 비즈니스 로직에 영향을 주지 않음
- 사용자 경험 개선: 좋아요 응답 시간 단축, 주문 처리의 응답성 향상
- 유지보수성 향상: 주요 로직과 부가 로직의 명확한 경계로 코드 이해도 증가
- 확장성 확보: 새로운 부가 로직 추가 시 기존 코드 변경 최소화

## 2. 기능 요구사항

### 2.1 주문-결제 플로우

- 주문 및 결제 생성과 PG사 연동 및 결제 진행을 분리한다
- 결제 실패 시 리소스(포인트, 쿠폰, 재고)가 정합성 있게 복구되어야 한다
- 주문/결제 결과를 데이터 플랫폼에 전송한다 (실패해도 주요 로직에 영향 없음)

### 2.2 좋아요-집계 플로우

- 좋아요 처리와 집계를 분리한다
- 집계 실패와 무관하게 좋아요는 정상 완료되어야 한다 (Eventual Consistency)

### 2.3 공통

- 유저 행동(상품 조회, 좋아요, 주문 등)을 서버 레벨에서 로깅한다 (실패해도 주요 로직에 영향 없음)
